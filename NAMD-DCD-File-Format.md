NAMD 32bit DCD File Format
==

NAMD DCD trajectory files are generated by NAMD (molecular dynamics simulation software). They consist of sequence of blocks where each block has the form

                   int => $blockLength
    byte[$blockLength] => $blockData
                   int == $blockLength

Last `int` at the end of the block must much with the value at the beginning  of the block and and can be used to validate file format.

The file contains following set of elements:

```
  header block    // contains magic header and other information
   title block    // just a text
  natoms block    // contains just one number, which is number of atoms that are tracked by each frame
fixedIdx block    // optional block that contains index of free atoms.
frame[1:n]        // one or more of sets of three blocks of atom coordinates at a given time moment
    x coord block // block describing x coordinates
    y coord block // block describing y coordinates
    z coord block // block describing z coordinates
```

The last frame contains three blocks, each of length 0, which means that is really a sequence of 6 ints of value 0 each

In the table below you see detailed description of each field within each block. The OP is an
operation, which can be either `=>` (assignment to a variable) or `==` (assertion to compare value with
known variable or a `byte/int/char[*]`). Array variables are start with `@` and scalars with `$` like in Perl.

Also note:
  
  - If `$fixed_atoms > 0` then index of atom within corresponding pdb file must be translated using `@index` array
  - Endiannes of the file can be deterimened by reading first four bytes of the file and converting to int in big
    and little endiannes. Whichever endiannes gives value 84 is the one used throughout the file. 

Complete format is as follows:

```
       BYTE OFFSET  |       TYPE[AMOUNT] OP VALUE/NAME
--------------------|----------------------------------------------------------------------
                 0  |                int == 84
                 4  |            byte[4] == 'CORD'
                 8  |                int => $nset // number of frames
                12  |                int => $istart // t0
                16  |                int => $nsavc // time steps between frames 
                20  |             int[5] == <unused>
                40  |                int => $fixed_atoms // number of fixed atoms
                44  |              float => $dt // time step
                48  |            int[10] == <unused>
                88  |                int == 84 // size of first block
--------------------|----------------------------------------------------------------------
                92  |                int => $title_blk_size // (($_ - 4) % 80) == 0
                96  |                int => $ntitle // number of 80 character title strings
               100  | byte[$ntitle * 80] => $title
100 + $ntitle * 80  |                int == $title_blk_size
--------------------|----------------------------------------------------------------------
104 + $ntitle * 80  |                int == 4
108 + $ntitle * 80  |                int => $natoms // total number of atoms
112 + $ntitle * 80  |                int == 4
--------------------|----------------------------------------------------------------------
#$free_atoms = $natoms - $fixed_atoms
#if $fixed_atoms > 0|
116 + $ntitle * 80  |                int == $free_atoms  * 4
120 + $ntitle * 80  |   int[$feee_atoms] => @free_indexes
120 + $title_bytes  |
  + $free_atoms * 4 |                int == $free_atoms * 4
#fi                 |
--------------------|----------------------------------------------------------------------
-- FRAME[*]         |
                    |                int == 4 * $free_atoms or 0 indicating end of frames
                    | float[$feee_atoms] => @x // x - coordinate
                    |                int == 4 * $feee_atoms
                    |
                    |                int == 4 * $free_atoms 
                    | float[$feee_atoms] => @y // y - coordinate
                    |                int == 4 * $free_atoms
                    |
                    |                int == 4 * $free_atoms 
                    | float[$feee_atoms] => @z // z - coordinate
                    |                int == 4 * $free_atoms
--------------------|----------------------------------------------------------------------
```